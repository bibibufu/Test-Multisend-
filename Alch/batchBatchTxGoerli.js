const { Alchemy, Network, Wallet, Utils } = require("alchemy-sdk");
const dotenv = require("dotenv");

dotenv.config();
const { API_KEY_GOERLI, PK } = process.env;

const settings = {
  apiKey: API_KEY_GOERLI,
  network: Network.ETH_GOERLI,
};
const alchemy = new Alchemy(settings);

let wallet = new Wallet(PK);


async function main() {
  const nonce = await alchemy.core.getTransactionCount(
    wallet.address,
    "latest"
  );
  for (let i = nonce; i <= nonce + 0; i++) {
    let transaction = {
      to: "0xb15E860b8ecf08B41F3a1832e834a3bEf8cf9EEd",
      value: Utils.parseEther("0"),
      data: "0x8d80ff0a0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000034b00eff92a263d31888d860bd50809a8d171709b7b1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010438ed173900000000000000000000000000000000000000000000000000038d7ea4c68000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000b15e860b8ecf08b41f3a1832e834a3bef8cf9eed00000000000000000000000000000000000000000000000000000002540be3ff0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000b4fbf271143f4fbf7b91a5ded31805e42b2208d60000000000000000000000006da4d6b3b058dd09f3094d5997c8092d7a532ff2006da4d6b3b058dd09f3094d5997c8092d7a532ff200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044095ea7b3000000000000000000000000eff92a263d31888d860bd50809a8d171709b7b1c00000000000000000000000000000000000000000052b7d2dcc80cd2e3ffffff00eff92a263d31888d860bd50809a8d171709b7b1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010438ed1739000000000000000000000000000000000000000000000000027f7d0bdb920000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a000000000000000000000000094ccded7bf952bcdf8ab81615b4139cf3ff0dbf400000000000000000000000000000000000000000000000000000002540be3ff00000000000000000000000000000000000000000000000000000000000000020000000000000000000000006da4d6b3b058dd09f3094d5997c8092d7a532ff2000000000000000000000000b4fbf271143f4fbf7b91a5ded31805e42b2208d6000000000000000000000000000000000000000000",
      gasLimit: "21000000",
      maxPriorityFeePerGas: Utils.parseUnits("4", "gwei"),
      maxFeePerGas: Utils.parseUnits("40", "gwei"),
      nonce: i,
      type: 2,
      chainId: 5,
    };
    let rawTransaction = await wallet.signTransaction(transaction);
    let tx = await alchemy.core.sendTransaction(rawTransaction);
    console.log("Sent transaction", tx);
  }

}

main();